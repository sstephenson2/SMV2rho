<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>SMV2rho: Tutorial 2 &#8212; SMV2rho v1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=cb25574f" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script src="../_static/documentation_options.js?v=76e2d817"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SMV2rho: Tutorial 3" href="tutorial_3.html" />
    <link rel="prev" title="SMV2rho: Tutorial 1" href="tutorial_1.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="SMV2rho:-Tutorial-2">
<h1>SMV2rho: Tutorial 2<a class="headerlink" href="#SMV2rho:-Tutorial-2" title="Link to this heading">¶</a></h1>
<p>In this tutorial we will see how we can convert a velocity profile to density using Brocher’s (2005) approach.</p>
<p>We will try out two ways of doing this. First, we will use the class construct that we developed in <code class="docutils literal notranslate"><span class="pre">tutorial_1</span></code>, and secondly we will use a function to provide flexibility for various different uses.</p>
<p>First let’s import the required modules from <code class="docutils literal notranslate"><span class="pre">SMV2rho</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import modules</span>
<span class="kn">from</span> <span class="nn">SMV2rho</span> <span class="kn">import</span> <span class="n">plotting</span> <span class="k">as</span> <span class="n">smplt</span>
<span class="kn">from</span> <span class="nn">SMV2rho</span> <span class="kn">import</span> <span class="n">density_functions</span> <span class="k">as</span> <span class="n">smd</span>
</pre></div>
</div>
</div>
<section id="Class-approach">
<h2>Class approach<a class="headerlink" href="#Class-approach" title="Link to this heading">¶</a></h2>
<section id="Load-file">
<h3>Load file<a class="headerlink" href="#Load-file" title="Link to this heading">¶</a></h3>
<p>We can load in the test Vp velocity profile. Since we are using the default file structure, we won’t specify <code class="docutils literal notranslate"><span class="pre">seismic_method_name</span></code> or <code class="docutils literal notranslate"><span class="pre">region_name</span></code> this time.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># path to test velocity file</span>
<span class="c1">#  - this file comes with the distribution so there is no need to change this path</span>
<span class="n">vp_file</span> <span class="o">=</span> <span class="s2">&quot;../TEST_DATA/EUROPE/Vp/RECEIVER_FUNCTION/DATA/M19_AQU_Vp.dat&quot;</span>

<span class="c1"># load a profile into the Convert class</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">smd</span><span class="o">.</span><span class="n">Convert</span><span class="p">(</span><span class="n">vp_file</span><span class="p">,</span> <span class="n">profile_type</span> <span class="o">=</span> <span class="s2">&quot;Vp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Read-data">
<h3>Read data<a class="headerlink" href="#Read-data" title="Link to this heading">¶</a></h3>
<p>Now read the data in the velocity profile file.</p>
<p>We can inspect the data dictionary that has been read from the input file by inspecting the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute. Type</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>profile.data
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read data</span>
<span class="n">profile</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
<span class="n">profile</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;station&#39;: &#39;M19_AQU_Vp&#39;,
 &#39;Vp_file&#39;: &#39;../TEST_DATA/EUROPE/Vp/RECEIVER_FUNCTION/DATA/M19_AQU_Vp.dat&#39;,
 &#39;region&#39;: None,
 &#39;moho&#39;: 37.2,
 &#39;location&#39;: array([13.48, 42.34]),
 &#39;av_Vp&#39;: 6.617358544354839,
 &#39;Vp&#39;: array([[  0.     ,   4.84865],
        [ -2.5    ,   4.84865],
        [ -2.51   ,   7.23144],
        [-16.2    ,   7.23144],
        [-16.21   ,   6.42768],
        [-37.2    ,   6.42768]]),
 &#39;type&#39;: &#39;Vp&#39;,
 &#39;method&#39;: &#39;EUROPE&#39;,
 &#39;geotherm&#39;: None}
</pre></div></div>
</div>
</section>
<section id="Convert-profile">
<h3>Convert profile<a class="headerlink" href="#Convert-profile" title="Link to this heading">¶</a></h3>
<p>Now we can convert the profile using the <code class="docutils literal notranslate"><span class="pre">Vp_to_density_brocher</span></code> method and inspect the updated data dictionary.</p>
<p>We can inspect the updated data dictionary by inspecting the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute by typing</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>profile.data
</pre></div>
</div>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">'rho'</span></code> and <code class="docutils literal notranslate"><span class="pre">'av_rho'</span></code> fields have been populated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># xonvert Vp profile using</span>
<span class="n">profile</span><span class="o">.</span><span class="n">Vp_to_density_brocher</span><span class="p">()</span>
<span class="c1"># show data diictionary</span>
<span class="n">profile</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;station&#39;: &#39;M19_AQU_Vp&#39;,
 &#39;Vp_file&#39;: &#39;../TEST_DATA/EUROPE/Vp/RECEIVER_FUNCTION/DATA/M19_AQU_Vp.dat&#39;,
 &#39;region&#39;: None,
 &#39;moho&#39;: 37.2,
 &#39;location&#39;: array([13.48, 42.34]),
 &#39;av_Vp&#39;: 6.617358544354839,
 &#39;Vp&#39;: array([[  0.     ,   4.84865],
        [ -2.5    ,   4.84865],
        [ -2.51   ,   7.23144],
        [-16.2    ,   7.23144],
        [-16.21   ,   6.42768],
        [-37.2    ,   6.42768]]),
 &#39;type&#39;: &#39;Vp&#39;,
 &#39;method&#39;: &#39;EUROPE&#39;,
 &#39;geotherm&#39;: None,
 &#39;rho&#39;: array([[  0.        ,   2.5119241 ],
        [ -2.5       ,   2.5119241 ],
        [ -2.51      ,   3.03672643],
        [-16.2       ,   3.03672643],
        [-16.21      ,   2.81506916],
        [-37.2       ,   2.81506916]]),
 &#39;av_rho&#39;: 2.8762876075085257}
</pre></div></div>
</div>
</section>
<section id="Plotting">
<h3>Plotting<a class="headerlink" href="#Plotting" title="Link to this heading">¶</a></h3>
<p>We can plot this <code class="docutils literal notranslate"><span class="pre">'rho'</span></code> profile using some of the routines in the <code class="docutils literal notranslate"><span class="pre">plotting</span></code> module.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># organise data for pltting</span>
<span class="n">data1</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">profile</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Vp&quot;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span>
          <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">profile</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Vp&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span>
          <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Vp&quot;</span><span class="p">}]</span>

<span class="n">data2</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">profile</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span>
          <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">profile</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span>
          <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\rho$, Brocher (2005)&#39;</span><span class="p">}]</span>

<span class="c1"># Call the plot_panels function</span>
<span class="n">smplt</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">],</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Velocity&#39;</span><span class="p">,</span> <span class="s1">&#39;Density&#39;</span><span class="p">],</span>
            <span class="n">xlabels</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{V_P}</span><span class="s1">$ (km/s)&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rho$ (Mg/m${^3}$)&#39;</span><span class="p">],</span>
            <span class="n">ylabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Depth (km)&#39;</span><span class="p">,</span> <span class="s1">&#39;Depth (km)&#39;</span><span class="p">],</span>
            <span class="n">z_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figure_scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/TUTORIALS_tutorial_2_9_0.png" src="../_images/TUTORIALS_tutorial_2_9_0.png" />
</div>
</div>
</section>
</section>
<section id="Function-approach">
<h2>Function approach<a class="headerlink" href="#Function-approach" title="Link to this heading">¶</a></h2>
<p>Alternatively, if we prefer to work with functions rather than classes, then we can convert the velocity profile using a wrapper function. In this case, everything is calculated and the appropriate classes and functions are called in the backend so that the user doesn’t have to run individual methods. This approach reduces flexibility but makes it possible to convert the profile into density with a one-liner. This function also becomes useful later on if we want to convert multiple profiles at
once and builds flexibility into the distriubution.</p>
<p>First let’s take a look at the docstring for the <code class="docutils literal notranslate"><span class="pre">convert_V_profile</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>smd.convert_V_profile<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span>
smd<span class="ansi-blue-fg">.</span>convert_V_profile<span class="ansi-blue-fg">(</span>
    file<span class="ansi-blue-fg">,</span>
    profile_type<span class="ansi-blue-fg">,</span>
    write_data<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    path<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    approach<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;stephenson&#39;</span><span class="ansi-blue-fg">,</span>
    location<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    parameters<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    constant_depth<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    constant_density<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    T_dependence<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    geotherm<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    print_working_file<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Convert a single Vp or Vs velocity profile to a density profile.

Args:
    file (str): Path to the input velocity profile file.
    profile_type (str): Type of velocity profile, &#39;Vp&#39; or &#39;Vs&#39;.
    write_data (bool, optional): If True, writes the converted data to
        files. Default is False.
    path (str, optional): Path to write the results. Default is None.
    approach (str, optional): Density conversion scheme to use, &#34;brocher&#34;
        or &#34;stephenson&#34;. Default is &#34;stephenson&#34;.
    location (str, optional): Regional location of the profile.
        Default is None.
    parameters (np.ndarray, optional): Instance of the Constants,
        VpConstants or VsConstants classes.  Must be instance
        of the Constants class with a material_constants object if
        T_dependence is set to True.
    constant_depth (float, optional): Depth range for constant density
        from the surface. Default is None.
    constant_density (float, optional): Constant density value for the
        uppermost x kilometers. Default is None.
    T_dependence (bool, optional): If True, corrects velocity and density
        for temperature and pressure. Default is False.
    geotherm (object, optional): Instance of the Geotherm class for
        temperature dependence.  Must be provided if T_dependence is set
        to True.  Default is None.
    print_working_file (bool, optional): If True, prints the file that is
        being converted. Default is False.

Returns:
    pd.DataFrame: DataFrame containing the converted velocity and
        density data.

Example:
    &gt;&gt;&gt; convert_V_profile(&#39;velocity_profile.dat&#39;, &#39;Vp&#39;, write_data=True,
    ...                   path=&#39;output/&#39;, approach=&#39;stephenson&#39;,
    ...                   location=&#39;Region1&#39;, parameters=constants_object,
    ...                   constant_depth=10.0, constant_density=2.7,
    ...                   T_dependence=True, geotherm=geotherm_object,
    ...                   print_working_file=True)
<span class="ansi-red-fg">File:</span>      ~/Work/SMV2rho/src/SMV2rho/density_functions.py
<span class="ansi-red-fg">Type:</span>      function
</pre></div></div>
</div>
<p>Now we can use it to convert our velocity profile using Brocher’s (2005) approach (i.e. the <em>Nafe-Drake</em> equation). This time, we should see an output string telling us the path to the file that is being converted. We can also print the output to check that the result is the same as before.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># call density conversion function</span>
<span class="c1"># note that using profile_type=&quot;Vs&quot; first calls a function to convert to Vp</span>
<span class="c1"># as is required by Brocher&#39;s (2005) approach.</span>
<span class="n">profile_brocher</span> <span class="o">=</span> <span class="n">smd</span><span class="o">.</span><span class="n">convert_V_profile</span><span class="p">(</span><span class="n">vp_file</span><span class="p">,</span>
                            <span class="n">profile_type</span><span class="o">=</span><span class="s2">&quot;Vp&quot;</span><span class="p">,</span>
                            <span class="n">approach</span><span class="o">=</span><span class="s2">&quot;brocher&quot;</span><span class="p">,</span>
                            <span class="n">print_working_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># print output dictionary to check values</span>
<span class="n">profile_brocher</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
working on ../TEST_DATA/EUROPE/Vp/RECEIVER_FUNCTION/DATA/M19_AQU_Vp.dat
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;station&#39;: &#39;M19_AQU_Vp&#39;,
 &#39;Vp_file&#39;: &#39;../TEST_DATA/EUROPE/Vp/RECEIVER_FUNCTION/DATA/M19_AQU_Vp.dat&#39;,
 &#39;region&#39;: None,
 &#39;moho&#39;: 37.2,
 &#39;location&#39;: array([13.48, 42.34]),
 &#39;av_Vp&#39;: 6.617358544354839,
 &#39;Vp&#39;: array([[  0.     ,   4.84865],
        [ -2.5    ,   4.84865],
        [ -2.51   ,   7.23144],
        [-16.2    ,   7.23144],
        [-16.21   ,   6.42768],
        [-37.2    ,   6.42768]]),
 &#39;type&#39;: &#39;Vp&#39;,
 &#39;method&#39;: &#39;EUROPE&#39;,
 &#39;geotherm&#39;: None,
 &#39;rho&#39;: array([[  0.        ,   2.5119241 ],
        [ -2.5       ,   2.5119241 ],
        [ -2.51      ,   3.03672643],
        [-16.2       ,   3.03672643],
        [-16.21      ,   2.81506916],
        [-37.2       ,   2.81506916]]),
 &#39;av_rho&#39;: 2.8762876075085257}
</pre></div></div>
</div>
<section id="id1">
<h3>Plotting<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>We can plot up the result to check it is the same as before</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># organise data for pltting</span>
<span class="n">data1</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">profile_brocher</span><span class="p">[</span><span class="s2">&quot;Vp&quot;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span>
          <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">profile_brocher</span><span class="p">[</span><span class="s2">&quot;Vp&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span>
          <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Vp&quot;</span><span class="p">}]</span>

<span class="n">data2</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">profile_brocher</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span>
          <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">profile_brocher</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span>
          <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\rho$, Brocher (2005)&#39;</span><span class="p">}]</span>

<span class="c1"># Call the plot_panels function</span>
<span class="n">smplt</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">],</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Velocity&#39;</span><span class="p">,</span> <span class="s1">&#39;Density&#39;</span><span class="p">],</span>
            <span class="n">xlabels</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{V_P}</span><span class="s1">$ (km/s)&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rho$ (Mg/m${^3}$)&#39;</span><span class="p">],</span>
            <span class="n">ylabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Depth (km)&#39;</span><span class="p">,</span> <span class="s1">&#39;Depth (km)&#39;</span><span class="p">],</span>
            <span class="n">z_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figure_scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/TUTORIALS_tutorial_2_15_0.png" src="../_images/TUTORIALS_tutorial_2_15_0.png" />
</div>
</div>
</section>
<section id="Converting-a-V_S-file">
<h3>Converting a <span class="math notranslate nohighlight">\(V_S\)</span> file<a class="headerlink" href="#Converting-a-V_S-file" title="Link to this heading">¶</a></h3>
<p>Converting a <span class="math notranslate nohighlight">\(V_S\)</span> file requires an extra step because the <em>Nafe-Drake</em> approach only provides a <span class="math notranslate nohighlight">\(V_P\)</span>-to-density conversion. We therefore first need to convert the profile into <span class="math notranslate nohighlight">\(V_P\)</span> and then into density.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vp_file</span> <span class="o">=</span> <span class="s2">&quot;../TEST_DATA/EUROPE/Vs/RECEIVER_FUNCTION/DATA/M19_AQU_Vs.dat&quot;</span>

<span class="c1"># load a profile into the Convert class</span>
<span class="n">profile_vs</span> <span class="o">=</span> <span class="n">smd</span><span class="o">.</span><span class="n">Convert</span><span class="p">(</span><span class="n">vp_file</span><span class="p">,</span> <span class="n">profile_type</span> <span class="o">=</span> <span class="s2">&quot;Vs&quot;</span><span class="p">)</span>
<span class="n">profile_vs</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now try and run the next cell to convert the profile into density. We can immediately see that we are trying to convert a <span class="math notranslate nohighlight">\(V_S\)</span> profile into density using an approach that is supposed to work only for <span class="math notranslate nohighlight">\(V_P\)</span> profiles.</p>
<p>To prevent this type of mistake, the program will throw a <code class="docutils literal notranslate"><span class="pre">NameError</span></code> because we have not yet generated a calculated <span class="math notranslate nohighlight">\(V_P\)</span> profile to convert into density.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile_vs</span><span class="o">.</span><span class="n">Vp_to_density_brocher</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">~/Work/SMV2rho/src/SMV2rho/density_functions.py:428</span>, in <span class="ansi-cyan-fg">Convert.Vp_to_density_brocher</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    427</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 428</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Vp_calc</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    429</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;Vp_calc&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[24], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">profile_vs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">Vp_to_density_brocher</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/Work/SMV2rho/src/SMV2rho/density_functions.py:430</span>, in <span class="ansi-cyan-fg">Convert.Vp_to_density_brocher</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    428</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>data[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Vp_calc</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    429</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">--&gt; 430</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">NameError</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">You haven</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">t created a Vp array yet! </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    431</span>               <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Convert Vs to Vp first!</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">    432</span>     rho <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>column_stack((<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>data[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Vp_calc</span><span style="color: rgb(175,0,0)">&#34;</span>][:,<span style="color: rgb(98,98,98)">0</span>],
<span class="ansi-green-intense-fg ansi-bold">    433</span>                            Vp2rho_brocher(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>data[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Vp_calc</span><span style="color: rgb(175,0,0)">&#34;</span>][:,<span style="color: rgb(98,98,98)">1</span>])))
<span class="ansi-green-intense-fg ansi-bold">    434</span> <span style="color: rgb(95,135,135)"># add Vs profile, average Vs and Vp/Vs ratio to dictionary</span>

<span class="ansi-red-fg">NameError</span>: You haven&#39;t created a Vp array yet! Convert Vs to Vp first!
</pre></div></div>
</div>
<p>We must first generate a calculated <span class="math notranslate nohighlight">\(V_P\)</span> profile using Brocher’s (2005) polynomial fit.</p>
<p>If we then print the data dictionary we can see that there is now a <code class="docutils literal notranslate"><span class="pre">'Vp_calc'</span></code> entry and an <code class="docutils literal notranslate"><span class="pre">'av_Vp_calc'</span></code> array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile_vs</span><span class="o">.</span><span class="n">Vs_to_Vp_brocher</span><span class="p">()</span>
<span class="n">profile_vs</span><span class="o">.</span><span class="n">Vp_to_density_brocher</span><span class="p">()</span>
<span class="n">profile_vs</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;station&#39;: &#39;M19_AQU_Vs&#39;,
 &#39;Vs_file&#39;: &#39;../TEST_DATA/EUROPE/Vs/RECEIVER_FUNCTION/DATA/M19_AQU_Vs.dat&#39;,
 &#39;region&#39;: None,
 &#39;moho&#39;: 37.2,
 &#39;location&#39;: array([13.48, 42.34]),
 &#39;av_Vs&#39;: 3.2977979690860213,
 &#39;Vs&#39;: array([[  0.     ,   2.19945],
        [ -2.5    ,   2.19945],
        [ -2.51   ,   3.45455],
        [-16.2    ,   3.45455],
        [-16.21   ,   3.32656],
        [-37.2    ,   3.32656]]),
 &#39;type&#39;: &#39;Vs&#39;,
 &#39;method&#39;: &#39;EUROPE&#39;,
 &#39;geotherm&#39;: None,
 &#39;Vp_calc&#39;: array([[  0.        ,   3.84569101],
        [ -2.5       ,   3.84569101],
        [ -2.51      ,   5.87049279],
        [-16.2       ,   5.87049279],
        [-16.21      ,   5.63121299],
        [-37.2       ,   5.63121299]]),
 &#39;av_Vp_calc&#39;: 5.59910010709708,
 &#39;Vp_calc_Vs&#39;: 1.6978299336659668,
 &#39;rho&#39;: array([[  0.        ,   2.37138868],
        [ -2.5       ,   2.37138868],
        [ -2.51      ,   2.68947595],
        [-16.2       ,   2.68947595],
        [-16.21      ,   2.6423109 ],
        [-37.2       ,   2.6423109 ]]),
 &#39;av_rho&#39;: 2.6414372703680047}
</pre></div></div>
</div>
<p>Converting using the function approach described above can be achieved with a one-liner, where converting frm <span class="math notranslate nohighlight">\(V_s\)</span> into <span class="math notranslate nohighlight">\(V_P\)</span> is handled internally and automatically.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># call density conversion function</span>
<span class="c1"># note that using profile_type=&quot;Vs&quot; first calls a function to convert to Vp</span>
<span class="c1"># as is required by Brocher&#39;s (2005) approach.</span>
<span class="n">profile_vs_brocher</span> <span class="o">=</span> <span class="n">smd</span><span class="o">.</span><span class="n">convert_V_profile</span><span class="p">(</span><span class="n">vp_file</span><span class="p">,</span>
                            <span class="n">profile_type</span><span class="o">=</span><span class="s2">&quot;Vs&quot;</span><span class="p">,</span>
                            <span class="n">approach</span><span class="o">=</span><span class="s2">&quot;brocher&quot;</span><span class="p">,</span>
                            <span class="n">print_working_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># print output dictionary to check values</span>
<span class="n">profile_vs_brocher</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
working on ../TEST_DATA/EUROPE/Vs/RECEIVER_FUNCTION/DATA/M19_AQU_Vs.dat
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;station&#39;: &#39;M19_AQU_Vs&#39;,
 &#39;Vs_file&#39;: &#39;../TEST_DATA/EUROPE/Vs/RECEIVER_FUNCTION/DATA/M19_AQU_Vs.dat&#39;,
 &#39;region&#39;: None,
 &#39;moho&#39;: 37.2,
 &#39;location&#39;: array([13.48, 42.34]),
 &#39;av_Vs&#39;: 3.2977979690860213,
 &#39;Vs&#39;: array([[  0.     ,   2.19945],
        [ -2.5    ,   2.19945],
        [ -2.51   ,   3.45455],
        [-16.2    ,   3.45455],
        [-16.21   ,   3.32656],
        [-37.2    ,   3.32656]]),
 &#39;type&#39;: &#39;Vs&#39;,
 &#39;method&#39;: &#39;EUROPE&#39;,
 &#39;geotherm&#39;: None,
 &#39;Vp_calc&#39;: array([[  0.        ,   3.84569101],
        [ -2.5       ,   3.84569101],
        [ -2.51      ,   5.87049279],
        [-16.2       ,   5.87049279],
        [-16.21      ,   5.63121299],
        [-37.2       ,   5.63121299]]),
 &#39;av_Vp_calc&#39;: 5.59910010709708,
 &#39;Vp_calc_Vs&#39;: 1.6978299336659668,
 &#39;rho&#39;: array([[  0.        ,   2.37138868],
        [ -2.5       ,   2.37138868],
        [ -2.51      ,   2.68947595],
        [-16.2       ,   2.68947595],
        [-16.21      ,   2.6423109 ],
        [-37.2       ,   2.6423109 ]]),
 &#39;av_rho&#39;: 2.6414372703680047}
</pre></div></div>
</div>
</section>
<section id="Summary">
<h3>Summary<a class="headerlink" href="#Summary" title="Link to this heading">¶</a></h3>
<p>We converted a <span class="math notranslate nohighlight">\(V_P\)</span> and <span class="math notranslate nohighlight">\(V_S\)</span> profile into density using Brocher’s (2005) approach, which exploits the <em>Nafe-Drake</em> relationship. We saw how we can convert these profiles using either a class approach or with a wrapper function to increase flexibility for your needs.</p>
<p>Note that this profile returns quite dramatically different density profiles for the <span class="math notranslate nohighlight">\(V_S\)</span> and <span class="math notranslate nohighlight">\(V_P\)</span> approaches. This difference may arise from local issues with either the imaging technique, assumed <span class="math notranslate nohighlight">\(V_P/V_S\)</span> ratio, or local geology. This degree of difference is relatively extreme, but does highlight the challenges in converting from seismic velocity to density and the inherent reliance on the accuracy of the underlying seismic velocity model and conversion scheme.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">SMV2rho</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial_1.html">SMV2rho: Tutorial 1</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SMV2rho: Tutorial 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Class-approach">Class approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Function-approach">Function approach</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_3.html">SMV2rho: Tutorial 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_4.html">SMV2rho: Tutorial 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_5.html">SMV2rho: Tutorial 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_6.html">SMV2rho: Tutorial 6</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_7.html">SMV2rho: Tutorial 7</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="tutorial_1.html" title="previous chapter">SMV2rho: Tutorial 1</a></li>
      <li>Next: <a href="tutorial_3.html" title="next chapter">SMV2rho: Tutorial 3</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, Simon Stephenson, Mark Hoggard.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/TUTORIALS/tutorial_2.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>